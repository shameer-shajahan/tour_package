{% extends 'base.html' %}

{% block title %}My Profile{% endblock %}

{% block content %}





     <!-- space  -->

     <div style="margin-top: 12rem;">

     </div>




<style>
    :root {
        --primary: #4F46E5;
        --primary-light: #EEF2FF;
        --primary-dark: #4338CA;
        --secondary: #10B981;
        --text-dark: #1F2937;
        --text-muted: #6B7280;
        --background: #F9FAFB;
        --card-bg: #FFFFFF;
        --border-radius: 16px;
    }

    .profile-container {
        padding: 3rem 1.5rem;
        background-color: var(--background);
    }

    .profile-card {
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .profile-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.08);
    }

    .profile-header {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        padding: 1.5rem;
        position: relative;
    }

    .profile-avatar-container {
        position: relative;
        margin-top: -75px;
        z-index: 1;
    }

    .profile-avatar {
        width: 150px;
        height: 150px;
        object-fit: cover;
        border: 5px solid white;
        border-radius: 50%;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .profile-avatar-placeholder {
        width: 150px;
        height: 150px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #CBD5E1;
        border: 5px solid white;
        border-radius: 50%;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        font-size: 3rem;
        color: white;
    }

    .profile-info {
        padding: 1rem 2rem 2rem;
    }

    .profile-name {
        font-size: 1.75rem;
        font-weight: 700;
        margin-bottom: 0.25rem;
        color: var(--text-dark);
    }

    .profile-member-since {
        color: var(--text-muted);
        font-size: 0.875rem;
        margin-bottom: 1.5rem;
    }

    .profile-detail-card {
        background-color: #F8FAFC;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        transition: transform 0.2s ease;
    }

    .profile-detail-card:hover {
        transform: translateY(-3px);
    }

    .profile-detail-label {
        color: var(--text-muted);
        font-size: 0.875rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .profile-detail-value {
        color: var(--text-dark);
        font-size: 1.125rem;
        font-weight: 500;
    }

    .badge-verified {
        background-color: #ECFDF5;
        color: #10B981;
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.35rem 0.75rem;
        border-radius: 9999px;
        display: inline-flex;
        align-items: center;
        margin-left: 0.5rem;
    }

    .badge-verified i {
        margin-right: 0.25rem;
    }

    .nav-menu {
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        overflow: hidden;
    }

    .nav-link {
        color: var(--text-dark);
        font-weight: 500;
        padding: 1rem 1.5rem;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        border-left: 3px solid transparent;
    }

    .nav-link i {
        margin-right: 0.75rem;
        font-size: 1.1rem;
        width: 20px;
        text-align: center;
    }

    .nav-link.active {
        background-color: var(--primary-light);
        color: var(--primary);
        border-left: 3px solid var(--primary);
    }

    .nav-link:hover:not(.active) {
        background-color: #F8FAFC;
    }

    .btn-edit {
        background-color: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .btn-edit:hover {
        background-color: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(79, 70, 229, 0.3);
    }

    .stats-card {
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        padding: 1.25rem;
        margin-bottom: 1rem;
        text-align: center;
        transition: transform 0.2s ease;
    }

    .stats-card:hover {
        transform: translateY(-3px);
    }

    .stats-value {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.25rem;
    }

    .stats-label {
        color: var(--text-muted);
        font-size: 0.875rem;
        font-weight: 500;
    }
</style>


<!-- Profile Content -->
<div style="margin-top: 12rem;"></div>

<div class="profile-container">
    <div class="container">
        <div class="row">
            <!-- Left Sidebar -->
            <div class="col-lg-3 col-md-4 mb-4">
                <div class="nav-menu mb-4">
                    <a href="{% url 'user_profile' %}" class="nav-link active">
                        <i class="fas fa-user"></i> My Profile
                    </a>
                    <a href="{% url 'update_profile' %}" class="nav-link">
                        <i class="fas fa-edit"></i> Edit Profile
                    </a>
                    <a href="{% url 'change_password' %}" class="nav-link">
                        <i class="fas fa-key"></i> Change Password
                    </a>
                    <a href="{% url 'user_booked_list' %}" class="nav-link">
                        <i class="fas fa-calendar-check"></i> My Bookings
                    </a>
                </div>

                              <!-- Stats Cards -->
                              <div class="stats-card">
                                <div class="stats-value">{{ booking_count|default:"0" }}</div>
                                <div class="stats-label">Total Bookings</div>
                            </div>
                            
                            <div class="stats-card">
                                <div class="stats-value">{{ completed_booking_count|default:"0" }}</div>
                                <div class="stats-label">Completed</div>
                            </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9 col-md-8">
                <div class="profile-card">
                    <!-- Profile Header Banner -->
                    <div class="profile-header">
                        <h4 class="mb-0"><i class="fas fa-key me-2"></i>Change Your Password</h4>
                    </div>
                    
                    <!-- Profile Information -->
                    <div class="profile-info text-center">
  
                  
                            
                        <div class="row justify-content-center">
                            <div >
                                <div class="card shadow-sm border-0 rounded-lg">
                                   
                                    <div>
                                        <form method="post" id="passwordChangeForm">
                                            {% csrf_token %}
                                            
                                            {% if form.non_field_errors %}
                                            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                                {% for error in form.non_field_errors %}
                                                {{ error }}
                                                {% endfor %}
                                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                            </div>
                                            {% endif %}
                                            
                                            {% if form.errors %}
                                            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                                <strong><i class="fas fa-exclamation-circle me-2"></i>Please correct the errors below:</strong>
                                                <ul class="mb-0 mt-2">
                                                    {% for field in form %}
                                                    {% for error in field.errors %}
                                                    <li>{{ field.label }}: {{ error }}</li>
                                                    {% endfor %}
                                                    {% endfor %}
                                                </ul>
                                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                            </div>
                                            {% endif %}
                        
                                            <!-- Current Password Field -->
                                            <div class="mb-4">
                                                <label for="{{ form.old_password.id_for_label }}" class="form-label fw-medium">
                                                    <i class="fas fa-lock me-2 text-muted"></i>Current Password
                                                </label>
                                                <div class="input-group">
                                                    {{ form.old_password|safe }}
                                                    <button class="btn btn-outline-secondary toggle-password" type="button" data-bs-toggle="tooltip" title="Show/Hide Password">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                                {% if form.old_password.errors %}
                                                <div class="invalid-feedback d-block mt-1">
                                                    {% for error in form.old_password.errors %}
                                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                                    {% endfor %}
                                                </div>
                                                {% endif %}
                                            </div>
                                            
                                            <!-- New Password Field -->
                                            <div class="mb-4">
                                                <label for="{{ form.new_password1.id_for_label }}" class="form-label fw-medium">
                                                    <i class="fas fa-key me-2 text-muted"></i>New Password
                                                </label>
                                                <div class="input-group">
                                                    {{ form.new_password1|safe }}
                                                    <button class="btn btn-outline-secondary toggle-password" type="button" data-bs-toggle="tooltip" title="Show/Hide Password">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                                
                                                <!-- Password Strength Meter -->
                                                <div class="password-strength mt-2">
                                                    <div class="progress" style="height: 6px;">
                                                        <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                                                    </div>
                                                    <div class="d-flex justify-content-between mt-1">
                                                        <small class="password-feedback text-muted">Password strength</small>
                                                        <small class="password-score text-muted"></small>
                                                    </div>
                                                </div>
                                                
                                                {% if form.new_password1.help_text %}
                                                <div class="password-requirements mt-2 p-3 bg-light rounded border">
                                                    <small class="form-text text-muted">
                                                        {{ form.new_password1.help_text|safe }}
                                                    </small>
                                                </div>
                                                {% endif %}
                                                
                                                {% if form.new_password1.errors %}
                                                <div class="invalid-feedback d-block mt-1">
                                                    {% for error in form.new_password1.errors %}
                                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                                    {% endfor %}
                                                </div>
                                                {% endif %}
                                            </div>
                                            
                                            <!-- Confirm Password Field -->
                                            <div class="mb-4">
                                                <label for="{{ form.new_password2.id_for_label }}" class="form-label fw-medium">
                                                    <i class="fas fa-check-circle me-2 text-muted"></i>Confirm New Password
                                                </label>
                                                <div class="input-group">
                                                    {{ form.new_password2|safe }}
                                                    <button class="btn btn-outline-secondary toggle-password" type="button" data-bs-toggle="tooltip" title="Show/Hide Password">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                                <div class="match-feedback mt-1">
                                                    <small></small>
                                                </div>
                                                {% if form.new_password2.errors %}
                                                <div class="invalid-feedback d-block mt-1">
                                                    {% for error in form.new_password2.errors %}
                                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                                    {% endfor %}
                                                </div>
                                                {% endif %}
                                            </div>
                                            
                                            <!-- Form Actions -->
                                            <div class="d-flex justify-content-end gap-3 mt-4 pt-3 border-top">
                                                <a href="{% url 'user_profile' %}" class="btn btn-dark">
                                                    <i class="fas fa-times me-2"></i>Cancel
                                                </a>
                                                <button type="submit" class="btn btn-primary px-4">
                                                    <i class="fas fa-save me-2"></i>Update Password
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                
                                <!-- Security Tips Card -->
                                <div class="card mt-4 border-0 shadow-sm bg-light">
                                    <div class="card-body p-3">
                                        <h5 class="card-title fw-bold"><i class="fas fa-shield-alt me-2 text-primary"></i>Password Security Tips</h5>
                                        <ul class="mb-0 ps-3">
                                            <li>Use a combination of letters, numbers, and symbols</li>
                                            <li>Avoid using easily guessable information (birthdays, names)</li>
                                            <li>Don't reuse passwords across multiple websites</li>
                                            <li>Consider using a password manager</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <style>
                        /* Enhanced Styles for Password Form */
                        .bg-gradient-primary {
                            background: linear-gradient(135deg, #4F46E5, #4338CA);
                        }
                        
                        .form-label {
                            font-weight: 500;
                            color: #374151;
                        }
                        
                        .form-control, .form-select {
                            padding: 0.75rem 1rem;
                            border: 1px solid #E5E7EB;
                            border-radius: 8px;
                            box-shadow: none;
                            transition: all 0.2s ease;
                        }
                        
                        .form-control:focus, .form-select:focus {
                            border-color: #4F46E5;
                            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
                        }
                        
                        .btn-primary {
                            background-color: #4F46E5;
                            border-color: #4F46E5;
                            font-weight: 500;
                            padding: 0.625rem 1.5rem;
                            border-radius: 8px;
                            transition: all 0.3s ease;
                        }
                        
                        .btn-primary:hover {
                            background-color: #4338CA;
                            border-color: #4338CA;
                            transform: translateY(-2px);
                            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
                        }
                        
                        .btn-light {
                            background-color: #F9FAFB;
                            border-color: #E5E7EB;
                            color: #6B7280;
                            font-weight: 500;
                            padding: 0.625rem 1.5rem;
                            border-radius: 8px;
                            transition: all 0.3s ease;
                        }
                        
                        .btn-light:hover {
                            background-color: #F3F4F6;
                            color: #4B5563;
                        }
                        
                        .toggle-password {
                            cursor: pointer;
                            border-top-right-radius: 8px;
                            border-bottom-right-radius: 8px;
                        }
                        
                        .card {
                            border-radius: 12px;
                            transition: transform 0.3s ease, box-shadow 0.3s ease;
                        }
                        
                        .password-requirements {
                            font-size: 0.85rem;
                        }
                        
                        .password-requirements ul {
                            padding-left: 1.5rem;
                            margin-bottom: 0;
                        }
                        
                        .password-requirements li.valid {
                            color: #10B981;
                        }
                        
                        .password-requirements li i {
                            margin-right: 0.25rem;
                        }
                        
                        /* Password Strength Colors */
                        .progress-bar.strength-1 { background-color: #EF4444; width: 20%; }
                        .progress-bar.strength-2 { background-color: #F59E0B; width: 40%; }
                        .progress-bar.strength-3 { background-color: #10B981; width: 60%; }
                        .progress-bar.strength-4 { background-color: #059669; width: 80%; }
                        .progress-bar.strength-5 { background-color: #047857; width: 100%; }
                        
                        .password-feedback.strength-1 { color: #EF4444; }
                        .password-feedback.strength-2 { color: #F59E0B; }
                        .password-feedback.strength-3 { color: #10B981; }
                        .password-feedback.strength-4 { color: #059669; }
                        .password-feedback.strength-5 { color: #047857; }
                        
                        .match-feedback .match-yes {
                            color: #10B981;
                        }
                        
                        .match-feedback .match-no {
                            color: #EF4444;
                        }
                        
                        /* Animated Focus Effect */
                        .input-group:focus-within {
                            transform: translateY(-1px);
                            transition: transform 0.2s ease;
                        }
                        
                        /* Additional modern touches */
                        .alert {
                            border-radius: 8px;
                            border: none;
                        }
                        
                        .alert-danger {
                            background-color: #FEF2F2;
                            color: #B91C1C;
                        }
                        
                        .card-header {
                            border-bottom: none; 
                        }
                        </style>
                        
                        <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            // Fix form-control class on labels (seems like a template mistake)
                            document.querySelectorAll('label.form-control').forEach(label => {
                                label.classList.remove('form-control');
                                label.classList.add('form-label');
                            });
                            
                            // Add Bootstrap classes to form inputs if they don't already have them
                            const formInputs = document.querySelectorAll('input[type="password"]');
                            formInputs.forEach(input => {
                                if (!input.classList.contains('form-control')) {
                                    input.classList.add('form-control');
                                }
                            });
                            
                            // Initialize tooltips
                            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                            tooltipTriggerList.map(function (tooltipTriggerEl) {
                                return new bootstrap.Tooltip(tooltipTriggerEl);
                            });
                            
                            // Toggle password visibility
                            document.querySelectorAll('.toggle-password').forEach(button => {
                                button.addEventListener('click', function() {
                                    const input = this.previousElementSibling;
                                    const icon = this.querySelector('i');
                                    
                                    if (input.type === 'password') {
                                        input.type = 'text';
                                        icon.classList.remove('fa-eye');
                                        icon.classList.add('fa-eye-slash');
                                    } else {
                                        input.type = 'password';
                                        icon.classList.remove('fa-eye-slash');
                                        icon.classList.add('fa-eye');
                                    }
                                });
                            });
                            
                            // Password strength meter
                            const newPassword = document.getElementById('{{ form.new_password1.id_for_label }}');
                            const confirmPassword = document.getElementById('{{ form.new_password2.id_for_label }}');
                            const progressBar = document.querySelector('.password-strength .progress-bar');
                            const passwordFeedback = document.querySelector('.password-feedback');
                            const passwordScore = document.querySelector('.password-score');
                            const matchFeedback = document.querySelector('.match-feedback small');
                            
                            if (newPassword) {
                                newPassword.addEventListener('input', function() {
                                    const value = this.value;
                                    let strength = 0;
                                    let feedback = '';
                                    
                                    // Calculate password strength
                                    if (value.length > 0) strength += 1;
                                    if (value.length >= 8) strength += 1;
                                    if (/[A-Z]/.test(value) && /[a-z]/.test(value)) strength += 1;
                                    if (/[0-9]/.test(value)) strength += 1;
                                    if (/[^A-Za-z0-9]/.test(value)) strength += 1;
                                    
                                    // Update progress bar
                                    progressBar.className = 'progress-bar strength-' + strength;
                                    
                                    // Set feedback text
                                    switch(strength) {
                                        case 1:
                                            feedback = 'Very weak';
                                            break;
                                        case 2:
                                            feedback = 'Weak';
                                            break;
                                        case 3:
                                            feedback = 'Medium';
                                            break;
                                        case 4:
                                            feedback = 'Strong';
                                            break;
                                        case 5:
                                            feedback = 'Very strong';
                                            break;
                                        default:
                                            feedback = 'Password strength';
                                    }
                                    
                                    passwordFeedback.textContent = feedback;
                                    passwordFeedback.className = 'password-feedback strength-' + strength;
                                    passwordScore.textContent = strength > 0 ? strength + '/5' : '';
                                    
                                    // Update requirements list if exists
                                    const requirements = document.querySelectorAll('.password-requirements li');
                                    if (requirements.length > 0) {
                                        // This is an example - you'll need to adjust based on your actual requirements
                                        if (/[A-Z]/.test(value)) {
                                            markRequirementValid(requirements, 'uppercase', true);
                                        } else {
                                            markRequirementValid(requirements, 'uppercase', false);
                                        }
                                        // Add similar checks for other requirements
                                    }
                                    
                                    // Check if passwords match
                                    checkPasswordsMatch();
                                });
                            }
                            
                            if (confirmPassword) {
                                confirmPassword.addEventListener('input', checkPasswordsMatch);
                            }
                            
                            function checkPasswordsMatch() {
                                if (newPassword.value && confirmPassword.value) {
                                    if (newPassword.value === confirmPassword.value) {
                                        matchFeedback.innerHTML = '<i class="fas fa-check-circle"></i> Passwords match';
                                        matchFeedback.className = 'match-yes';
                                    } else {
                                        matchFeedback.innerHTML = '<i class="fas fa-times-circle"></i> Passwords do not match';
                                        matchFeedback.className = 'match-no';
                                    }
                                } else {
                                    matchFeedback.textContent = '';
                                }
                            }
                            
                            function markRequirementValid(requirements, type, isValid) {
                                requirements.forEach(req => {
                                    if (req.textContent.toLowerCase().includes(type)) {
                                        if (isValid) {
                                            req.classList.add('valid');
                                            req.innerHTML = req.innerHTML.replace('<i class="fas fa-times"></i>', '<i class="fas fa-check"></i>');
                                        } else {
                                            req.classList.remove('valid');
                                            req.innerHTML = req.innerHTML.replace('<i class="fas fa-check"></i>', '<i class="fas fa-times"></i>');
                                        }
                                    }
                                });
                            }
                            
                            // Add subtle animation effects to form elements
                            const inputs = document.querySelectorAll('.form-control');
                            inputs.forEach(input => {
                                input.addEventListener('focus', function() {
                                    this.parentElement.classList.add('focused');
                                });
                                input.addEventListener('blur', function() {
                                    this.parentElement.classList.remove('focused');
                                });
                            });
                        });
                        </script>
                            
                      
                        
                            
                       
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>






{% endblock %}